var Pan;(()=>{"use strict";var e={d:(t,s)=>{for(var i in s)e.o(s,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:s[i]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{EventEmitter:()=>o,Mouse:()=>r,Screen:()=>a});class s{constructor(){this.reference=null,this.active=!1,this.consecutiveEmptyCalls=0}}class i{constructor(){this.requestAnimationFrame=new s}}class n{constructor(){this.queue=[],this.state=new i}static getInstance(){return void 0===n.instance&&(n.instance=new n),n.instance}addEvent(e,t){let s=!1;for(const i of this.queue)i.key===e&&(i.callstack.push(t),s=!0);s||this.queue.push({key:e,callstack:[t]}),this.state.requestAnimationFrame.active||this.startRequestAnimationFrame()}processEvents(){if(this.checkAnimationFrameStatus(this.queue)){const e=this.queue.length;for(let t=0;t<e;t++){const e=this.queue[t];e.callstack[e.callstack.length-1]()}0!==e&&this.queue.splice(0,e),this.queue.splice(0,e),requestAnimationFrame(this.processEvents.bind(this))}}checkAnimationFrameStatus(e){return 0===e.length?this.state.requestAnimationFrame.consecutiveEmptyCalls+=1:this.state.requestAnimationFrame.consecutiveEmptyCalls=0,!(this.state.requestAnimationFrame.consecutiveEmptyCalls>=600&&(this.endRequestAnimationFrame(),1))}startRequestAnimationFrame(){this.state.requestAnimationFrame.consecutiveEmptyCalls=0,this.state.requestAnimationFrame.active=!0,this.state.requestAnimationFrame.reference=requestAnimationFrame(this.processEvents.bind(this)),console.log("starting frame callstack")}endRequestAnimationFrame(){cancelAnimationFrame(this.state.requestAnimationFrame.reference),this.state.requestAnimationFrame.active=!1,console.log("ending frame callstack")}}class o{constructor(){this.animationQueue=n.getInstance(),this.eventMap=new Map,this.functionsMap=new Map}beforeOnEventListenerSetup(e){}setupEvents(e){var t,s;console.log(this.events,e),this.events.has(e)?this.registerEventListenerFunction(e,{initFunction:null===(t=this.events.get(e))||void 0===t?void 0:t.initFunction.bind(this),destroyFunction:null===(s=this.events.get(e))||void 0===s?void 0:s.destroyFunction.bind(this)}):console.warn("This is not a supported Event")}internalEmit(e,t){this.eventMap.has(e)&&this.eventMap.get(e).forEach((e=>{e(t)}))}internalOn(e,t){let s;this.beforeOnEventListenerSetup(e),this.setupEvents(e),void 0!==this.eventMap.get(e)?s=this.eventMap.get(e):(s=[],this.eventMap.set(e,s)),s.push(t)}emit(e,t){this.internalEmit(e,t)}on(e,t){this.internalOn(e,t)}registerEventListenerFunction(e,t){this.functionsMap.has(e)?console.warn("Function key already exists, calling register failed"):(t.initFunction(),this.functionsMap.set(e,t))}destroyEventEmitterFunction(e){if(this.functionsMap.has(e)){const t=this.functionsMap.get(e);null!=t&&t.destroyFunction(),this.functionsMap.delete(e)}else console.warn("Function key does not exist, calling destroy failed")}}class r extends o{constructor(){super(...arguments),this.settings={isMouseOnMoveEnabled:!1,isMouseClickEnabled:!1},this.events=new Map(Object.entries({move:{initFunction:()=>{this.registerMouseMoveEventListener()},destroyFunction:()=>{this.destroyMouseMoveEventListener()}},click:{initFunction:()=>{this.registerMouseClickEventListener()},destroyFunction:()=>{this.destroyMouseClickEventListener()}}}))}mouseMove(e){const t={x:e.offsetX,y:e.offsetY};this.emit("move",t)}mouseClick(e){let t=0;1===e.which||0===e.button?t=0:3!==e.which&&2!==e.button||(t=1);const s={x:e.offsetX,y:e.offsetY,button:t};this.emit("click",s)}registerMouseMoveEventListener(){this.settings.isMouseOnMoveEnabled||(window.addEventListener("mousemove",(e=>{this.mouseMove(e)})),this.settings.isMouseOnMoveEnabled=!0)}destroyMouseMoveEventListener(){window.removeEventListener("mousemove",this.mouseMove),this.settings.isMouseOnMoveEnabled=!1}registerMouseClickEventListener(){this.settings.isMouseClickEnabled||(window.addEventListener("click",(e=>{this.mouseClick(e)})),this.settings.isMouseClickEnabled=!0)}destroyMouseClickEventListener(){window.removeEventListener("click",this.mouseMove),this.settings.isMouseClickEnabled=!1}}class a extends o{constructor(){super(...arguments),this.settings={isScreenResizeEnabled:!1},this.events=new Map(Object.entries({resize:{initFunction:()=>{this.registerScreenResizeListener()},destroyFunction:()=>{this.destroyScreenResizeListener()}}}))}screenResize(){const e={width:window.innerWidth,height:window.innerHeight};this.emit("resize",e)}registerScreenResizeListener(){this.settings.isScreenResizeEnabled||(window.addEventListener("resize",(()=>{this.screenResize()})),this.settings.isScreenResizeEnabled=!0)}destroyScreenResizeListener(){window.removeEventListener("resize",this.screenResize),this.settings.isScreenResizeEnabled=!1}}Pan=t})();